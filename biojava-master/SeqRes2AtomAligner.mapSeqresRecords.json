{"callee_method_names":["Chain.getAtomGroups","Chain.getAtomGroups","Logger.debug","Chain.getId","List<Group>.size","Chain.getId","List<Group>.size","Chain.setSeqResGroups","Logger.debug","Chain.getAtomGroups","Chain.getAtomGroups","Logger.debug","Chain.getId","Logger.debug","Chain.getId","Chain.getAtomGroups","Logger.debug","Chain.getId","Logger.debug","Chain.getId","Chain.getAtomGroups","Chain.setSeqResGroups"],"method_name":"SeqRes2AtomAligner.mapSeqresRecords","method_implementation":"{\n    List<Group> seqResGroups = seqRes.getAtomGroups();\n    List<Group> atmResGroups = atomRes.getAtomGroups();\n    logger.debug(\"Comparing ATOM {} ({} groups) to SEQRES {} ({} groups) \", atomRes.getId(), atmResGroups.size(), seqRes.getId(), seqResGroups.size());\n    List<Group> matchedGroups = trySimpleMatch(seqResGroups, atmResGroups);\n    if (matchedGroups != null) {\n        // update the new SEQRES list\n        atomRes.setSeqResGroups(matchedGroups);\n        return;\n    }\n    logger.debug(\"Could not map SEQRES to ATOM records easily, need to align...\");\n    int numAminosSeqres = seqRes.getAtomGroups(GroupType.AMINOACID).size();\n    int numNucleotidesSeqres = seqRes.getAtomGroups(GroupType.NUCLEOTIDE).size();\n    if (numAminosSeqres < 1) {\n        if (numNucleotidesSeqres > 1) {\n            logger.debug(\"SEQRES chain {} is a nucleotide chain ({} nucleotides), aligning nucleotides...\", seqRes.getId(), numNucleotidesSeqres);\n            alignNucleotideChains(seqRes, atomRes);\n            return;\n        } else {\n            logger.debug(\"SEQRES chain {} contains {} amino acids and {} nucleotides, ignoring...\", seqRes.getId(), numAminosSeqres, numNucleotidesSeqres);\n            return;\n        }\n    }\n    if (atomRes.getAtomGroups(GroupType.AMINOACID).size() < 1) {\n        logger.debug(\"ATOM chain {} does not contain amino acids, ignoring...\", atomRes.getId());\n        return;\n    }\n    logger.debug(\"Proceeding to do protein alignment for chain {}\", atomRes.getId());\n    boolean noMatchFound = alignProteinChains(seqResGroups, atomRes.getAtomGroups());\n    if (!noMatchFound) {\n        atomRes.setSeqResGroups(seqResGroups);\n    }\n}","repo_id":"9","comment":"/**\n * Map the seqRes groups to the atomRes chain.\n * Updates the atomRes chain object with the mapped data\n * The seqRes chain should not be needed after this and atomRes should be further used.\n *\n * @param atomRes the chain containing ATOM groups (in atomGroups slot). This chain\n * is modified to contain in its seqresGroups slot the mapped atom groups\n * @param seqRes the chain containing SEQRES groups (in atomGroups slot). This chain\n * is not modified\n */\n","repo_name":"biojava-master/","id":1232,"method_signature":"void mapSeqresRecords(Chain, Chain)"}