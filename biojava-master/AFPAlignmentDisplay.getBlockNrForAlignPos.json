{"callee_method_ids":[487,490,489],"callee_method_names":["AFPChain.getBlockNum","AFPChain.getOptLen","AFPChain.getOptAln"],"method_name":"AFPAlignmentDisplay.getBlockNrForAlignPos","method_implementation":"{\n    // moved here from DisplayAFP;\n    int blockNum = afpChain.getBlockNum();\n    int[] optLen = afpChain.getOptLen();\n    int[][][] optAln = afpChain.getOptAln();\n    int len = 0;\n    int p1b = 0;\n    int p2b = 0;\n    for (int i = 0; i < blockNum; i++) {\n        for (int j = 0; j < optLen[i]; j++) {\n            int p1 = optAln[i][0][j];\n            int p2 = optAln[i][1][j];\n            if (len != 0) {\n                // check for gapped region\n                int lmax = (p1 - p1b - 1) > (p2 - p2b - 1) ? (p1 - p1b - 1) : (p2 - p2b - 1);\n                for (int k = 0; k < lmax; k++) {\n                    len++;\n                }\n            }\n            p1b = p1;\n            p2b = p2;\n            if (len >= aligPos) {\n                return i;\n            }\n            len++;\n        }\n    }\n    return blockNum;\n}","repo_id":"9","comment":"/**\n * get the block number for an aligned position\n *\n * @param afpChain\n * @param aligPos\n * @return\n */\n","repo_name":"biojava-master/","id":650,"method_signature":"int getBlockNrForAlignPos(AFPChain, int)"}