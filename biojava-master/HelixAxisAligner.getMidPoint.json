{"callee_method_ids":[1919],"callee_method_names":["Vector3d.sub","Vector3d.sub","Vector3d.add","Vector3d.add","Vector3d.normalize","Vector3d.length","HelixLayers.getByLargestContacts","Vector3d.scale","Vector3d.add"],"method_name":"HelixAxisAligner.getMidPoint","method_implementation":"{\n    Vector3d v1 = new Vector3d();\n    v1.sub(p1, p2);\n    Vector3d v2 = new Vector3d();\n    v2.sub(p3, p2);\n    Vector3d v3 = new Vector3d();\n    v3.add(v1);\n    v3.add(v2);\n    v3.normalize();\n    // calculat the total distance between to subunits\n    double dTotal = v1.length();\n    // calculate the rise along the y-axis. The helix axis is aligned with y-axis,\n    // therfore, the rise between subunits is the y-distance\n    double rise = p2.y - p1.y;\n    // use phythagorean theoremm to calculate chord length between two subunit centers\n    double chord = Math.sqrt(dTotal * dTotal - rise * rise);\n    //\t\tSystem.out.println(\"Chord d: \" + dTotal + \" rise: \" + rise + \"chord: \" + chord);\n    double angle = helixLayers.getByLargestContacts().getAxisAngle().angle;\n    // using the axis angle and the chord length, we can calculate the radius of the helix\n    // http://en.wikipedia.org/wiki/Chord_%28geometry%29\n    // can this go to zero?\n    double radius = chord / Math.sin(angle / 2) / 2;\n    //\t\tSystem.out.println(\"Radius: \" + radius);\n    // project the radius onto the vector that points toward the helix axis\n    v3.scale(radius);\n    v3.add(p2);\n    //\t\tSystem.out.println(\"Angle: \" + Math.toDegrees(helixLayers.getByLowestAngle().getAxisAngle().angle));\n    Point3d cor = new Point3d(v3);\n    return cor;\n}","repo_id":"9","comment":"/**\n * Return a midpoint of a helix, calculated from three positions\n * of three adjacent subunit centers.\n * @param p1 center of first subunit\n * @param p2 center of second subunit\n * @param p3 center of third subunit\n * @return midpoint of helix\n */\n","repo_name":"biojava-master/","id":1973,"method_signature":"Point3d getMidPoint(Point3d, Point3d, Point3d)"}