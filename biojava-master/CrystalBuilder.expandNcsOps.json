{"callee_method_ids":[1415,1415,1415],"callee_method_names":["Structure.getCrystallographicInfo","PDBCrystallographicInfo.getNcsOperators","PDBCrystallographicInfo.getNcsOperators","Matrix4d.setIdentity","PDBCrystallographicInfo.getNcsOperators","Structure.getChains","Class.getId","Class.getName","Class.clone","Chain.setId","Chain.setName","List<Chain>.add","Class.getEntityInfo","Map<String,String>.put","Map<String,Matrix4d>.put","Map<String,Matrix4d>.put","Map<String,String>.put","List<Chain>.forEach"],"method_name":"CrystalBuilder.expandNcsOps","method_implementation":"{\n    PDBCrystallographicInfo xtalInfo = structure.getCrystallographicInfo();\n    if (xtalInfo == null)\n        return;\n    if (xtalInfo.getNcsOperators() == null || xtalInfo.getNcsOperators().length == 0)\n        return;\n    List<Chain> chainsToAdd = new ArrayList<>();\n    Matrix4d identity = new Matrix4d();\n    identity.setIdentity();\n    Matrix4d[] ncsOps = xtalInfo.getNcsOperators();\n    for (Chain c : structure.getChains()) {\n        String cOrigId = c.getId();\n        String cOrigName = c.getName();\n        for (int iOperator = 0; iOperator < ncsOps.length; iOperator++) {\n            Matrix4d m = ncsOps[iOperator];\n            Chain clonedChain = (Chain) c.clone();\n            String newChainId = cOrigId + (iOperator + 1) + NCS_CHAINID_SUFFIX_CHAR;\n            String newChainName = cOrigName + (iOperator + 1) + NCS_CHAINID_SUFFIX_CHAR;\n            clonedChain.setId(newChainId);\n            clonedChain.setName(newChainName);\n            setChainIdsInResidueNumbers(clonedChain, newChainName);\n            Calc.transform(clonedChain, m);\n            chainsToAdd.add(clonedChain);\n            c.getEntityInfo().addChain(clonedChain);\n            chainOrigNames.put(newChainName, cOrigName);\n            chainNcsOps.put(newChainName, m);\n        }\n        chainNcsOps.put(cOrigName, identity);\n        chainOrigNames.put(cOrigName, cOrigName);\n    }\n    chainsToAdd.forEach(structure::addChain);\n}","repo_id":"9","comment":"/**\n * Apply the NCS operators in the given Structure adding new chains as needed.\n * All chains are (re)assigned ids of the form: original_chain_id+ncs_operator_index+{@value #NCS_CHAINID_SUFFIX_CHAR}.\n * @param structure\n *          the structure to expand\n * @param chainOrigNames\n *          new chain names mapped to the original chain names\n * @param chainNcsOps\n *          new chain names mapped to the ncs operators that was used to generate them\n * @since 5.0.0\n */\n","repo_name":"biojava-master/","id":1442,"method_signature":"void expandNcsOps(Structure, Map, Map)"}