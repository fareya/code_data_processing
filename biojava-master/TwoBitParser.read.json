{"callee_method_names":["Logger.debug","RandomAccessFile.getFilePointer"],"method_name":"TwoBitParser.read","method_implementation":"{\n    if (cur_seq_name == null)\n        throw new IOException(\"Sequence is not set\");\n    if (cur_seq_pos == cur_dna_size) {\n        logger.debug(\"End of sequence (file position:{})\", raf.getFilePointer());\n        return -1;\n    }\n    int bit_num = (int) cur_seq_pos % 4;\n    if (bit_num == 0) {\n        loadBits();\n    } else if (bit_num == 3) {\n        file_pos++;\n    }\n    char ret = 'N';\n    if ((cur_nn_block_num >= 0) && (cur_nn_blocks[cur_nn_block_num][0] <= cur_seq_pos)) {\n        if (cur_bits[bit_num] != 0) {\n            throw new IOException(\"Wrong data in NN-block (\" + cur_bits[bit_num] + \") \" + \"at position \" + cur_seq_pos);\n        }\n        if (cur_nn_blocks[cur_nn_block_num][0] + cur_nn_blocks[cur_nn_block_num][1] == cur_seq_pos + 1) {\n            cur_nn_block_num++;\n            if (cur_nn_block_num >= cur_nn_blocks.length) {\n                cur_nn_block_num = -1;\n            }\n        }\n        ret = 'N';\n    } else {\n        ret = bit_chars[cur_bits[bit_num]];\n    }\n    if ((cur_mask_block_num >= 0) && (cur_mask_blocks[cur_mask_block_num][0] <= cur_seq_pos)) {\n        ret = Character.toLowerCase(ret);\n        if (cur_mask_blocks[cur_mask_block_num][0] + cur_mask_blocks[cur_mask_block_num][1] == cur_seq_pos + 1) {\n            cur_mask_block_num++;\n            if (cur_mask_block_num >= cur_mask_blocks.length) {\n                cur_mask_block_num = -1;\n            }\n        }\n    }\n    cur_seq_pos++;\n    return ret;\n}","repo_id":"9","comment":"/**\n * Method reads 1 nucleotide from sequence stream. You should set current sequence\n * before use it.\n */\n","repo_name":"biojava-master/","id":2383,"method_signature":"int read()"}