{"callee_method_names":["List<ModifiedCompound>.size","List<ModifiedCompound>.get","ModifiedCompound.getModification","TreeSet<Integer>.contains","List<ModifiedCompound>.get","ModifiedCompound.getGroups","ModifiedCompound.getGroups","List<ModifiedCompound>.get","ModifiedCompound.getModification","ModifiedCompound.addAtomLinkages","ModifiedCompound.getAtomLinkages","TreeSet<Integer>.add","TreeSet<Integer>.descendingIterator","Iterator<Integer>.hasNext","List<ModifiedCompound>.remove","Iterator<Integer>.next"],"method_name":"ProteinModificationIdentifier.mergeModComps","method_implementation":"{\n    TreeSet<Integer> remove = new TreeSet<Integer>();\n    int n = modComps.size();\n    for (int icurr = 1; icurr < n; icurr++) {\n        ModifiedCompound curr = modComps.get(icurr);\n        String id = curr.getModification().getId();\n        if (ProteinModificationRegistry.getById(id).getCategory() != ModificationCategory.UNDEFINED)\n            continue;\n        // find linked compounds that before curr\n        //List<Integer> merging = new ArrayList<Integer>();\n        int ipre = 0;\n        for (; ipre < icurr; ipre++) {\n            if (remove.contains(ipre))\n                continue;\n            ModifiedCompound pre = modComps.get(ipre);\n            if (!Collections.disjoint(pre.getGroups(false), curr.getGroups(false))) {\n                break;\n            }\n        }\n        if (ipre < icurr) {\n            ModifiedCompound mcKeep = modComps.get(ipre);\n            // merge modifications of the same type\n            if (mcKeep.getModification().getId().equals(id)) {\n                // merging the current one to the previous one\n                mcKeep.addAtomLinkages(curr.getAtomLinkages());\n                remove.add(icurr);\n            }\n        }\n    }\n    Iterator<Integer> it = remove.descendingIterator();\n    while (it.hasNext()) {\n        modComps.remove(it.next().intValue());\n    }\n}","repo_id":"9","comment":"/**\n * Merge identified modified compounds if linked.\n */\n","repo_name":"biojava-master/","id":300,"method_signature":"void mergeModComps(List)"}