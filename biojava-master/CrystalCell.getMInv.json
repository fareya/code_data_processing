{"callee_method_names":[],"method_name":"CrystalCell.getMInv","method_implementation":"{\n    if (Minv != null) {\n        return Minv;\n    }\n    // see eq. 2.30 Giacovazzo\n    Minv = new Matrix3d(this.a, 0, 0, this.b * Math.cos(gammaRad), this.b * Math.sin(gammaRad), 0, this.c * Math.cos(betaRad), -this.c * Math.sin(betaRad) * getCosAlphaStar(), 1.0 / getCstar());\n    return Minv;\n}","repo_id":"9","comment":"/**\n * Returns the change of basis (crystal to orthonormal) transform matrix, that is\n * M inverse in the notation of Giacovazzo.\n * Using the PDB axes convention\n * (CCP4 uses NCODE identifiers to distinguish the different conventions, the PDB one is called NCODE=1)\n * The matrix is only calculated upon first call of this method, thereafter it is cached.\n * See \"Fundamentals of Crystallography\" C. Giacovazzo, section 2.5 (eq 2.30)\n *\n * The non-standard orthogonalisation codes (NCODE for ccp4) are flagged in REMARK 285 after 2011's remediation\n * with text: \"THE ENTRY COORDINATES ARE NOT PRESENTED IN THE STANDARD CRYSTAL FRAME\". There were only 148 PDB\n * entries with non-standard code in 2011. See:\n * http://www.wwpdb.org/documentation/2011remediation_overview-061711.pdf\n * The SCALE1,2,3 records contain the correct transformation matrix (what Giacovazzo calls M matrix).\n * In those cases if we calculate the M matrix following Giacovazzo's equations here, we get an entirely wrong one.\n * Examples of PDB with non-standard orthogonalisation are 1bab and 1bbb.\n * @return\n */\n","repo_name":"biojava-master/","id":1473,"method_signature":"Matrix3d getMInv()"}